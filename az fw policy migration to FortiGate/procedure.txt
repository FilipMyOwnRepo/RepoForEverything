MIGRATING GROUPS AND OBJECTS 

First part is to migrate all the groups and objects. Everything for this part is placed in "groups and objects" folder.
You MUST have 2 files: commands_output.txt and income_rules.txt literally the same name either the code won't work. 
Otherwise change it in the code (lines 9 and 10).

In the "income_rules.txt" file you can put group name in one line and then IP one by one, row by row (check this file).
Group must contain less then 101 characters or it must be changed in the code (line 22). As well, "income_rules.txt" 
file must contain less then 100 lines. 

Be aware to put one empty line after the last IP in the group (like in income_rules.txt file). The code is searching
the last line and it won't work if you forget about it. At the end, please put 2-3 empty lines. It happens that code
doesn't read until the last line of code. 

As well, be aware that you can delete characters for the Group ":" and the IPs "  - " in the code: lines 22 (group), 
30 and 44 (for IPs). I had the same yaml file as put: "example.yml" so I created the code like this.

After debbuging the code the pop-up window (command prompt) will show all the IPs (that code read). With this, I was
checking if the code is working fine. Except: if there is a range, it won't be outputted!

You just need to put all these commands to the FortiGate and... voila... all the the objects and groups are there!
--------------------------------------------------------------------------------------------------------------------
Exporting the policy

Next step is to export the policy from Azure firewall. I found the PowerShell script on the internet:
Link: https://github.com/proximagr/automation/blob/master/Export%20Azure%20Firewall%20Policy%20Rules.ps1
You can find this script in the folder "export policy" as well.

If it is not working, check "troubleshooting.txt" file under "export policy" folder.

At the end, file called "rule" should be in c:\temp
---------------------------------------------------------------------------------------------------------------------
If in the excel file everything is in the column A, you can change it with this:
 - Mark column A
 - Go to "Data"
 - Go to "Text to Column"
 - Mark "Delimited"
 - Mark checkbox "Comma"
 - Click "Finish"
Now everything should be in the separated column.
---------------------------------------------------------------------------------------------------------------------
WORKING WITH EXCEL AND NOTEPAD++

I picked up Notepad++ as I like it and it was easier for me, but actually everything could be done only in Excel.
Mostly everything in this step is "Find and Replace" thing.

First find and replace in Excel is:
/subscriptions/*/resourceGroups/<RG name>/providers/Microsoft.Network/<file name>/<group name> -> ""
======================================================================================================================
CREATING SOURCE AND DESTINATION IPS ON FortiGate

If we want to use source and destination IPs on FortiGate in the policy or to add them in the group, we need to create
them first as the objects.

The procedure is the same for both columns, but I will just mention the source IPs. 

Creating (this part is not covering the ranges so they must be rechecked and created separately !):
 - Copy the column Source IPs to the Notepad++
 - Find and replace: "," -> "\n"
 - Find and replace: " " -> ""
 - Find and replace: "\r\n\r\n" -> ""
 - Delete everything but IPs (e.g. "*" or "SourceAddresses"). You can do as well find and replace: "*" -> ""
 - Recheck the hole file again if there are any mistakes. Every IP needs to be in the separated row
 - Check the folder "migrating IPs" and file "IP_procedure.txt" 
 - When you have the commands from "source_commands.txt" file, "shoot" them on FortiGate. You can do it as commands or
 do like script import

 Now all the source IPs are created on FortiGate. Same part of the procedure is for destination IPs. 







